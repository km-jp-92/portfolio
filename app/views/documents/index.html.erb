<div 
  class="min-h-screen bg-gray-50 px-4 py-10"
  data-controller="pdf-upload"
  data-pdf-upload-target="dropzone">

  <% if flash[:notice] %>
    <p class="text-green-600 mb-2 text-center"><%= flash[:notice] %></p>
  <% elsif flash[:alert] %>
    <p class="text-red-600 mb-2 text-center"><%= flash[:alert] %></p>
  <% end %>

  <!-- 左上の + アップロードボタン -->
  <div class="max-w-2xl mx-auto mb-6 flex justify-start">
    <label 
      for="file-upload-input"
      class="w-12 h-12 flex items-center justify-center rounded-full bg-blue-500 
             text-white shadow hover:bg-blue-600 cursor-pointer transition"
    >
      <span class="text-2xl">＋</span>
    </label>
  </div>

  <!-- アップロードフォーム -->
  <%= form_with model: @document, url: documents_path(token: @document_group.upload_token), html: { multipart: true },
    data: { turbo: false, pdf_upload_target: "form" } do |f| %>
      
    <!-- エラーメッセージ表示 -->
    <% if @document.errors.any? %>
      <div class="mb-4 bg-red-50 border border-red-400 text-red-700 p-3 rounded w-full max-w-2xl mx-auto">
        <h3 class="font-semibold">アップロードできませんでした：</h3>
        <ul class="list-disc pl-5">
          <% @document.errors.full_messages.each do |msg| %>
            <li><%= msg %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <%= f.file_field :files, id: "file-upload-input", multiple: true, accept: "application/pdf", direct_upload: true,
      data: { action: "change->pdf-upload#upload", pdf_upload_target: "fileInput" }, class: "hidden" %>
    
  <% end %>

  <!-- PDF一覧 -->
  <div class="bg-white p-6 rounded-2xl shadow-md border border-gray-100 w-full max-w-2xl mx-auto">
    <% if @documents.any? %>
      <ul class="divide-y divide-gray-200">
        <% @documents.each do |doc| %>
        <% next unless doc.file.attached? %>
          <li class="flex items-center justify-between py-3">
            <%= link_to doc.file.filename.to_s, url_for(doc.file), target: "_blank", class: "text-blue-600 font-medium hover:underline truncate" %>
            <%= link_to "×", destroy_document_path(@document_group.upload_token, doc), data: { turbo_method: :delete, turbo_confirm: "削除しますか？" }, 
              class: "bg-red-500 hover:bg-red-600 text-white text-sm py-1 px-3 rounded-md transition" %>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p class="text-gray-500 text-center">まだアップロードされていません</p>
    <% end %>
  </div>
</div>
